<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Author: Giuseppe Campanelli -->
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
      xmlns:p="http://primefaces.org/ui">
    <body>
        <ui:composition template="./templates/masterTemplate.xhtml">
            <ui:define name="title">
                <h:outputText value="#{bookBB.book.title}"/>
            </ui:define>
            
            <ui:define name="content">
                <div class="row columns">
                    <nav aria-label="You are here:" role="navigation">
                        <h:form>
                        <ul class="breadcrumbs">
                            <li><a href="home.xhtml">Home</a></li>
                            <li><a href="#"><h:commandLink value="#{bookBB.genreName}" action="#{searchActionBean.browseGenre(bookBB.genreName)}"/></a></li>
                            <li>
                                <h:outputText value="#{bookBB.book.title}"/>
                            </li>
                        </ul>
                        </h:form>
                    </nav>
                </div>
                <div class="row">
                    <div class="medium-6 columns">
                        <h:graphicImage styleClass="thumbnail imageMax" value="resources/images/#{bookBB.book.isbn}.jpg"/>
                    </div>
                    <div class="medium-6 large-5 columns">
                        <h3 class="noMargin"><h:outputText value="#{bookBB.book.title}"/></h3>
                        <table class="plainTable">
                            <tr>
                                <td class="noPadding"><label><p:rating value="#{bookBB.starsForOverallRating}" readonly="true"/></label></td>
                                <td class="noPadding"><label>&nbsp;<h:outputText value="[#{bookBB.reviewsAmount}]"/></label></td>
                            </tr>
                        </table>
                        <h5><h:outputText value="#{bookBB.authors}"/></h5> <!--authors concatenated-->
                        <p><h:outputText value="#{bookBB.book.synopsis}"/></p>	
                        <h:form id="buyBookNow">
                            <c:if test="#{bookBB.book.listPrice != bookBB.book.salePrice}">
                                <div class="row">
                                    <div class="small-3 columns">
                                        <label for="middle-label" class="middle">List Price:</label>
                                    </div>
                                    <div class="small-9 columns">
                                        <label for="middle-label" class="middle"><strike><h:outputText value="$#{bookBB.book.listPrice}"/></strike></label>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="small-3 columns">
                                        <label for="middle-label" class="middle">Sale Price:</label>
                                    </div>
                                    <div class="small-9 columns">
                                        <label for="middle-label" class="middle"><h:outputText styleClass="red" value="$#{bookBB.book.salePrice}"/></label>
                                    </div>
                                </div>
                            </c:if>
                            <c:if test="#{bookBB.book.listPrice == bookBB.book.salePrice}">
                                <div class="row">
                                    <div class="small-3 columns">
                                        <label for="middle-label" class="middle">Price:</label>
                                    </div>
                                    <div class="small-9 columns">
                                        <label for="middle-label" class="middle"><h:outputText value="$#{bookBB.book.listPrice}"/></label>
                                    </div>
                                </div>
                            </c:if>
                            <div class="row">
                                <div class="small-3 columns">
                                    <label for="middle-label" class="middle">Quantity:</label>
                                </div>
                                <div class="small-9 columns">
                                    <h:inputText id="middle-label" value="1" onkeypress="if(event.which &lt; 48 || event.which &gt; 57) return false;"/>
                                </div>
                            </div>
                            <h:commandLink styleClass="button large expanded">Add To Cart <i class="fi-shopping-cart"/></h:commandLink> <!-- not a commandButton like the submit review-->
                        </h:form>
                    </div>
                </div>
                <div class="column row">
                    <hr/>
                    <ul class="tabs" data-tabs="" id="example-tabs">
                        <li class="tabs-title is-active"><a href="#panel1" aria-selected="true">Product Details</a></li>
                        <li class="tabs-title"><a href="#panel2">Reviews</a></li>
                        <li class="tabs-title"><a href="#panel3">Similar Products</a></li>
                    </ul>
                    <div class="tabs-content" data-tabs-content="example-tabs">
                        <div class="tabs-panel is-active" id="panel1">
                            <div class="media-object stack-for-small">
                                <div class="media-object-section">
                                    <b>ISBN:</b>
                                    <p><h:outputText value="#{bookBB.book.isbn}"/></p>
                                    <b>Publisher:</b>
                                    <p><h:outputText value="#{bookBB.book.publisher}"/></p>
                                    <b>Publish Date:</b>
                                    <p><h:outputText value="#{bookBB.formatDate(bookBB.book.publishDate)}"/></p>
                                    <b>Pages:</b>
                                    <p><h:outputText value="#{bookBB.book.pageNumber}"/></p>
                                    <b>Genre:</b>
                                    <p><h:outputText value="#{bookBB.genres}"/></p> <!-- list of genres concatenated-->
                                    <b>Formats:</b>
                                    <p><h:outputText value="#{bookBB.formats}"/></p> <!-- list of formats concatenated-->
                                </div>
                            </div>
                        </div>
                        <div class="tabs-panel" id="panel2">
                            <ui:repeat var="item" value="#{bookBB.book.reviewList}">
                                <div class="media-object stack-for-small">
                                    <div class="media-object-section">
                                        <h5><h:outputText value="#{item.reviewTitle}"/></h5><h:outputText value="#{bookBB.formatDate(item.dateSubmitted)}"/>
                                        <p:rating value="#{item.rating}" readonly="true"/><label>by <h:outputText value="#{item.userId.firstName} #{item.userId.lastName}"/></label>
                                        <p><h:outputText value="#{item.reviewText}"/></p>
                                    </div>
                                </div>
                            </ui:repeat>
                            <hr/>
                            <h5>My Review:</h5>
                            <h:form id="submitReview">
                                <p:rating value="0"/>
                                <br/>
                                <h:inputTextarea/>
                                <h:commandButton styleClass="button" value="Submit Review"/>
                            </h:form>
                        </div>
                        <div class="tabs-panel" id="panel3">
                            <div class="row small-up-2 medium-up-3 large-up-6">
                                <ui:repeat var="item" value="#{bookBB.similarProducts}">
                                    <div class="column ">
                                        <h:graphicImage styleClass="thumbnail" value="resources/images/#{item.isbn}.jpg"/>
                                        <h:form><h6><h:commandLink value="#{item.title}" action="#{bookBB.displayBook(item)}"/></h6></h:form>
                                        <ui:fragment rendered="#{item.listPrice == item.salePrice}">
                                            <p><h:outputText value="$#{item.listPrice}"/></p>
                                        </ui:fragment>
                                        <ui:fragment rendered="#{item.listPrice != item.salePrice}">
                                            <p><strike><h:outputText value="$#{item.listPrice}"/></strike>&nbsp;<h:outputText styleClass="red" value="$#{item.salePrice}"/></p>
                                        </ui:fragment>
                                    </div>
                                </ui:repeat>
                            </div>
                        </div>
                    </div>
                </div>
            </ui:define>
            
            <ui:define name="bottom">
                bottom
            </ui:define>
        </ui:composition>
    </body>
</html>

